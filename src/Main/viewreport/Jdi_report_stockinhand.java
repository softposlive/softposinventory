package Main.viewreport;

import Main.browser.Jdi_browse_stockfile;
import Main.browser.Jdi_browse_vender;
import report.ViewReport;
import DBcontrol.MySQLConnect;
import Main.browser.jdi_showgroupfile;
import java.awt.Color;
import java.awt.event.ActionEvent;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.Locale;
import java.util.Vector;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.SwingConstants;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;
import javax.swing.table.TableColumnModel;
import utilities.NimbusFrame;
import utilities.date_time.DateAndTime;

public class Jdi_report_stockinhand extends javax.swing.JDialog {

    /** Creates new form Jdi_report_stockinhand */
    public Jdi_report_stockinhand(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        DefaultComboBoxModel cbm = (DefaultComboBoxModel) cbYear1.getModel();
        setYear(cbm);
        cbm = (DefaultComboBoxModel) cbYear2.getModel();
        setYear(cbm);
        cbm = (DefaultComboBoxModel) cbYear3.getModel();
        setYear(cbm);

        mPro = (DefaultTableModel) tblProduct.getModel();
        mGroup = (DefaultTableModel) tblGroup.getModel();
        mVen = (DefaultTableModel) tblVender.getModel();
        
        /// add for set month ///////
        SimpleDateFormat DateFmt = new SimpleDateFormat("dd/MM/yyyy", Locale.ENGLISH);
        Date date = new Date() ;
        String tdate = DateFmt.format(date) ;
        Calendar ca2 = new GregorianCalendar() ;
        int dd = Integer.parseInt(tdate.substring(0, 2)) ;
        int mm = Integer.parseInt(tdate.substring(3, 5)) ;
        int yy = Integer.parseInt(tdate.substring(6, 10)) ;
        cbMonth1.setSelectedIndex(mm-1);
        cbMonth2.setSelectedIndex(mm-1);
        cbMonth3.setSelectedIndex(mm-1);
        

        setTableProduct();
        setTableGroup();
        setTableVender();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        cbMonth1 = new javax.swing.JComboBox();
        jLabel6 = new javax.swing.JLabel();
        cbYear1 = new javax.swing.JComboBox();
        jPanel10 = new javax.swing.JPanel();
        txtStockFile1 = new javax.swing.JTextField();
        cmdStk1 = new javax.swing.JButton();
        lbStockFile1 = new javax.swing.JLabel();
        cmdProcess1 = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        jPanel12 = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        txtPcode1 = new javax.swing.JTextField();
        txtPdesc1 = new javax.swing.JTextField();
        txtGroupFile1 = new javax.swing.JTextField();
        cmdGroupFile1 = new javax.swing.JButton();
        txtGroupFile2 = new javax.swing.JTextField();
        cmdGroupFile2 = new javax.swing.JButton();
        txtVender1 = new javax.swing.JTextField();
        cmdVender1 = new javax.swing.JButton();
        jLabel11 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblProduct = new javax.swing.JTable();
        jPanel13 = new javax.swing.JPanel();
        txtBqty1 = new javax.swing.JTextField();
        txtAmount1 = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jPanel11 = new javax.swing.JPanel();
        txtRowCount1 = new javax.swing.JTextField();
        cmdPrint1 = new javax.swing.JButton();
        jRadioButton1 = new javax.swing.JRadioButton();
        jRadioButton2 = new javax.swing.JRadioButton();
        jRadioButton3 = new javax.swing.JRadioButton();
        jPanel2 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        cbMonth2 = new javax.swing.JComboBox();
        jLabel3 = new javax.swing.JLabel();
        cbYear2 = new javax.swing.JComboBox();
        jPanel6 = new javax.swing.JPanel();
        txtStockFile2 = new javax.swing.JTextField();
        cmdStk2 = new javax.swing.JButton();
        lbStockFile2 = new javax.swing.JLabel();
        cmdProcess2 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblGroup = new javax.swing.JTable();
        jPanel7 = new javax.swing.JPanel();
        txtRowCount2 = new javax.swing.JTextField();
        cmdPrint2 = new javax.swing.JButton();
        txtAmount2 = new javax.swing.JTextField();
        jLabel17 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jPanel14 = new javax.swing.JPanel();
        jPanel15 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        cbMonth3 = new javax.swing.JComboBox();
        jLabel14 = new javax.swing.JLabel();
        cbYear3 = new javax.swing.JComboBox();
        jPanel16 = new javax.swing.JPanel();
        txtStockFile3 = new javax.swing.JTextField();
        cmdStk3 = new javax.swing.JButton();
        lbStockFile3 = new javax.swing.JLabel();
        cmdProcess3 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblVender = new javax.swing.JTable();
        jPanel17 = new javax.swing.JPanel();
        txtRowCount3 = new javax.swing.JTextField();
        cmdPrint3 = new javax.swing.JButton();
        txtAmount3 = new javax.swing.JTextField();
        jLabel18 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("รายงานสินค้าคงเหลือ (Stock Inhand)");

        jTabbedPane1.setFont(new java.awt.Font("Norasi", 0, 14));

        jPanel8.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดงวดเดือน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        jLabel4.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel4.setText("เดือน");

        cbMonth1.setEditable(true);
        cbMonth1.setFont(new java.awt.Font("Norasi", 0, 14));
        cbMonth1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12" }));
        cbMonth1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbMonth1KeyReleased(evt);
            }
        });

        jLabel6.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel6.setText("ปี");

        cbYear1.setEditable(true);
        cbYear1.setFont(new java.awt.Font("Norasi", 0, 14));
        cbYear1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "0000" }));
        cbYear1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbYear1KeyReleased(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel4)
                .addGap(4, 4, 4)
                .addComponent(cbMonth1, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(94, 94, 94)
                .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 8, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(cbYear1, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel9Layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                        .addComponent(cbMonth1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel9Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel9Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(cbYear1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดสต็อก", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        txtStockFile1.setFont(new java.awt.Font("Norasi", 0, 14));
        txtStockFile1.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtStockFile1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtStockFile1FocusGained(evt);
            }
        });
        txtStockFile1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtStockFile1KeyReleased(evt);
            }
        });

        cmdStk1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdStk1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdStk1ActionPerformed(evt);
            }
        });

        lbStockFile1.setFont(new java.awt.Font("Norasi", 1, 14));

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtStockFile1, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(cmdStk1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbStockFile1, javax.swing.GroupLayout.DEFAULT_SIZE, 150, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(txtStockFile1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cmdStk1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(lbStockFile1, javax.swing.GroupLayout.Alignment.CENTER, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(12, 12, 12))
        );

        cmdProcess1.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdProcess1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/SandClock.png"))); // NOI18N
        cmdProcess1.setText("F5-ประมวณผล");
        cmdProcess1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdProcess1ActionPerformed(evt);
            }
        });
        cmdProcess1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                cmdProcess1KeyPressed(evt);
            }
        });

        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.gif"))); // NOI18N
        jButton1.setText("Exit");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(263, 263, 263)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(cmdProcess1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addComponent(jButton1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cmdProcess1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                        .addComponent(jPanel10, javax.swing.GroupLayout.Alignment.LEADING, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel9, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 78, Short.MAX_VALUE)))
                .addGap(0, 0, 0))
        );

        jPanel12.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel7.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel7.setText("รหัสสินค้า (PLU Code)");

        jLabel8.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel8.setText("ชื่อสินค้า (Description)");

        jLabel9.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel9.setText("รหัสกลุ่ม(Group)");

        jLabel10.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel10.setText("รหัสผู้จำหน่าย (Vender)");

        txtPcode1.setFont(new java.awt.Font("Norasi", 0, 14));
        txtPcode1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtPcode1FocusGained(evt);
            }
        });
        txtPcode1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPcode1KeyReleased(evt);
            }
        });

        txtPdesc1.setFont(new java.awt.Font("Norasi", 0, 14));
        txtPdesc1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtPdesc1FocusGained(evt);
            }
        });
        txtPdesc1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPdesc1KeyReleased(evt);
            }
        });

        txtGroupFile1.setFont(new java.awt.Font("Norasi", 0, 14));
        txtGroupFile1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtGroupFile1KeyReleased(evt);
            }
        });

        cmdGroupFile1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdGroupFile1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdGroupFile1ActionPerformed(evt);
            }
        });

        txtGroupFile2.setFont(new java.awt.Font("Norasi", 0, 14));
        txtGroupFile2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtGroupFile2KeyReleased(evt);
            }
        });

        cmdGroupFile2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdGroupFile2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdGroupFile2ActionPerformed(evt);
            }
        });

        txtVender1.setFont(new java.awt.Font("Norasi", 0, 14));
        txtVender1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtVender1KeyReleased(evt);
            }
        });

        cmdVender1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdVender1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdVender1ActionPerformed(evt);
            }
        });

        jLabel11.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel11.setText("ถึง");

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7))
                .addGap(0, 0, 0)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel8)
                    .addComponent(txtPdesc1, javax.swing.GroupLayout.PREFERRED_SIZE, 316, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(txtGroupFile1, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(cmdGroupFile1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(3, 3, 3)
                        .addComponent(jLabel11)
                        .addGap(2, 2, 2)
                        .addComponent(txtGroupFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(cmdGroupFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel9))
                .addGap(36, 36, 36)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel10)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(txtVender1, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(cmdVender1, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(53, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(txtVender1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cmdVender1)))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, 0)
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(txtPcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtPdesc1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(txtGroupFile1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cmdGroupFile2)
                            .addComponent(txtGroupFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cmdGroupFile1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel11))))
                .addGap(0, 0, 0))
        );

        tblProduct.setAutoCreateRowSorter(true);
        tblProduct.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "คลัง", "รหัสสินค้า (PLU Code)", "ชื่อสินค้า (Description)", "กลุ่ม", "Vender", "จำนวนคงเหลือ", "หน่วย", "ราคา / หน่วย", "มูลค่าคงเหลือ"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane2.setViewportView(tblProduct);

        jPanel13.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        txtBqty1.setEditable(false);
        txtBqty1.setFont(new java.awt.Font("Norasi", 1, 14));
        txtBqty1.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtBqty1.setText("0");
        txtBqty1.setFocusable(false);

        txtAmount1.setEditable(false);
        txtAmount1.setFont(new java.awt.Font("Norasi", 1, 14));
        txtAmount1.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtAmount1.setText("0");
        txtAmount1.setFocusable(false);

        jLabel13.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel13.setText("มูลค่าคงเหลือ");

        jLabel15.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel15.setText("จำนวนคงเหลือ");

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addContainerGap(415, Short.MAX_VALUE)
                .addComponent(jLabel15)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtBqty1, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(119, 119, 119)
                .addComponent(jLabel13)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtAmount1, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(24, 24, 24))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jLabel13, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtAmount1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtBqty1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        txtRowCount1.setEditable(false);
        txtRowCount1.setFont(new java.awt.Font("Norasi", 1, 14));
        txtRowCount1.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtRowCount1.setText("0 รายการ");
        txtRowCount1.setFocusable(false);

        cmdPrint1.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdPrint1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/print.gif"))); // NOI18N
        cmdPrint1.setText("พิมพ์");
        cmdPrint1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPrint1ActionPerformed(evt);
            }
        });
        cmdPrint1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cmdPrint1KeyReleased(evt);
            }
        });

        buttonGroup1.add(jRadioButton1);
        jRadioButton1.setFont(new java.awt.Font("Norasi", 0, 14));
        jRadioButton1.setText("เรียงตามรหัสสินค้า (PLU)");

        buttonGroup1.add(jRadioButton2);
        jRadioButton2.setFont(new java.awt.Font("Norasi", 0, 14));
        jRadioButton2.setSelected(true);
        jRadioButton2.setText("แยกตามแผนกสินค้า (Group)");

        buttonGroup1.add(jRadioButton3);
        jRadioButton3.setFont(new java.awt.Font("Norasi", 0, 14));
        jRadioButton3.setText("แยกตามผู้ขาย (Vender)");

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtRowCount1, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(54, 54, 54)
                .addComponent(jRadioButton1)
                .addGap(18, 18, 18)
                .addComponent(jRadioButton2)
                .addGap(27, 27, 27)
                .addComponent(jRadioButton3)
                .addGap(123, 123, 123)
                .addComponent(cmdPrint1, javax.swing.GroupLayout.DEFAULT_SIZE, 74, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtRowCount1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdPrint1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jRadioButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jRadioButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jRadioButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 980, Short.MAX_VALUE)
                    .addComponent(jPanel13, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 400, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(134, 134, 134))
        );

        jTabbedPane1.addTab("รายงานสินค้าคงเหลือ เรียงตามรหัสสินค้า(PLU Code)", jPanel1);

        jPanel4.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดงวดเดือน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        jLabel1.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel1.setText("เดือน");

        cbMonth2.setEditable(true);
        cbMonth2.setFont(new java.awt.Font("Norasi", 0, 14));
        cbMonth2.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12" }));
        cbMonth2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbMonth2KeyReleased(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel3.setText("ปี");

        cbYear2.setEditable(true);
        cbYear2.setFont(new java.awt.Font("Norasi", 0, 14));
        cbYear2.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "0000" }));
        cbYear2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbYear2KeyReleased(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(4, 4, 4)
                .addComponent(cbMonth2, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(94, 94, 94)
                .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 8, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(cbYear2, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel5Layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                        .addComponent(cbMonth2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel5Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel5Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(cbYear2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดสต็อก", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        txtStockFile2.setFont(new java.awt.Font("Norasi", 0, 14));
        txtStockFile2.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtStockFile2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtStockFile2FocusGained(evt);
            }
        });
        txtStockFile2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtStockFile2KeyReleased(evt);
            }
        });

        cmdStk2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdStk2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdStk2ActionPerformed(evt);
            }
        });

        lbStockFile2.setFont(new java.awt.Font("Norasi", 1, 14));

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtStockFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(cmdStk2, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbStockFile2, javax.swing.GroupLayout.DEFAULT_SIZE, 150, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(lbStockFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdStk2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtStockFile2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(12, 12, 12))
        );

        cmdProcess2.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdProcess2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/SandClock.png"))); // NOI18N
        cmdProcess2.setText("F5-ประมวณผล");
        cmdProcess2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdProcess2ActionPerformed(evt);
            }
        });
        cmdProcess2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                cmdProcess2KeyPressed(evt);
            }
        });

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.gif"))); // NOI18N
        jButton2.setText("Exit");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(263, 263, 263)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jButton2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(cmdProcess2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(2, 2, 2)
                        .addComponent(jButton2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cmdProcess2))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(0, 0, 0)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel5, javax.swing.GroupLayout.Alignment.TRAILING, 0, 78, Short.MAX_VALUE)
                            .addComponent(jPanel6, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addGap(0, 0, 0))
        );

        tblGroup.setAutoCreateRowSorter(true);
        tblGroup.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "คลัง", "รหัสกลุ่ม (Group)", "ชื่อกล่มสินค้า (Description)", "มูลค่าคงเหลือ"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(tblGroup);

        jPanel7.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        txtRowCount2.setEditable(false);
        txtRowCount2.setFont(new java.awt.Font("Norasi", 0, 14));
        txtRowCount2.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtRowCount2.setText("0 รายการ");
        txtRowCount2.setFocusable(false);

        cmdPrint2.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdPrint2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/print.gif"))); // NOI18N
        cmdPrint2.setText("พิมพ์");
        cmdPrint2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPrint2ActionPerformed(evt);
            }
        });
        cmdPrint2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cmdPrint2KeyReleased(evt);
            }
        });

        txtAmount2.setEditable(false);
        txtAmount2.setFont(new java.awt.Font("Norasi", 0, 14));
        txtAmount2.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtAmount2.setText("0");
        txtAmount2.setFocusable(false);

        jLabel17.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel17.setText("มูลค่าคงเหลือ");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtRowCount2, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(409, 409, 409)
                .addComponent(jLabel17)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtAmount2, javax.swing.GroupLayout.PREFERRED_SIZE, 186, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(55, 55, 55)
                .addComponent(cmdPrint2, javax.swing.GroupLayout.DEFAULT_SIZE, 67, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtRowCount2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdPrint2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtAmount2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 980, Short.MAX_VALUE)
                    .addComponent(jPanel4, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel7, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 511, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(127, 127, 127))
        );

        jTabbedPane1.addTab("สรุปมูลค่าสินค้าคงเหลือตามแผนกสินค้า (Group)", jPanel2);

        jPanel14.setBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        jPanel15.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดงวดเดือน", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        jLabel12.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel12.setText("เดือน");

        cbMonth3.setEditable(true);
        cbMonth3.setFont(new java.awt.Font("Norasi", 0, 14));
        cbMonth3.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12" }));
        cbMonth3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbMonth3KeyReleased(evt);
            }
        });

        jLabel14.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel14.setText("ปี");

        cbYear3.setEditable(true);
        cbYear3.setFont(new java.awt.Font("Norasi", 0, 14));
        cbYear3.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "0000" }));
        cbYear3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cbYear3KeyReleased(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel12)
                .addGap(4, 4, 4)
                .addComponent(cbMonth3, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(94, 94, 94)
                .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 8, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(4, 4, 4)
                .addComponent(cbYear3, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel15Layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                        .addComponent(cbMonth3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel15Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(jLabel14, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(javax.swing.GroupLayout.Alignment.CENTER, jPanel15Layout.createSequentialGroup()
                    .addGap(2, 2, 2)
                    .addComponent(cbYear3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        jPanel16.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "กำหนดสต็อก", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        txtStockFile3.setFont(new java.awt.Font("Norasi", 0, 14));
        txtStockFile3.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtStockFile3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtStockFile3FocusGained(evt);
            }
        });
        txtStockFile3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtStockFile3KeyReleased(evt);
            }
        });

        cmdStk3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/magnifying glass.jpg"))); // NOI18N
        cmdStk3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdStk3ActionPerformed(evt);
            }
        });

        lbStockFile3.setFont(new java.awt.Font("Norasi", 1, 14));

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtStockFile3, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(cmdStk3, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbStockFile3, javax.swing.GroupLayout.DEFAULT_SIZE, 150, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(lbStockFile3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdStk3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtStockFile3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(16, 16, 16))
        );

        cmdProcess3.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdProcess3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/SandClock.png"))); // NOI18N
        cmdProcess3.setText("F5-ประมวณผล");
        cmdProcess3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdProcess3ActionPerformed(evt);
            }
        });
        cmdProcess3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                cmdProcess3KeyPressed(evt);
            }
        });

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.gif"))); // NOI18N
        jButton3.setText("Exit");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(263, 263, 263)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jButton3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(cmdProcess3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jButton3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cmdProcess3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addGap(0, 0, 0)
                        .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel15, javax.swing.GroupLayout.Alignment.TRAILING, 0, 82, Short.MAX_VALUE)
                            .addComponent(jPanel16, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 82, Short.MAX_VALUE))))
                .addGap(0, 0, 0))
        );

        tblVender.setAutoCreateRowSorter(true);
        tblVender.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "คลัง", "รหัสผู้ขาย (Vender)", "ชื่อผู้ขาย / บริษัท", "มูลค่าคงเหลือ"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane3.setViewportView(tblVender);

        jPanel17.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        txtRowCount3.setEditable(false);
        txtRowCount3.setFont(new java.awt.Font("Norasi", 0, 14));
        txtRowCount3.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtRowCount3.setText("0 รายการ");
        txtRowCount3.setFocusable(false);

        cmdPrint3.setFont(new java.awt.Font("Norasi", 1, 14));
        cmdPrint3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/print.gif"))); // NOI18N
        cmdPrint3.setText("พิมพ์");
        cmdPrint3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cmdPrint3ActionPerformed(evt);
            }
        });
        cmdPrint3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                cmdPrint3KeyReleased(evt);
            }
        });

        txtAmount3.setEditable(false);
        txtAmount3.setFont(new java.awt.Font("Norasi", 0, 14));
        txtAmount3.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtAmount3.setText("0");
        txtAmount3.setFocusable(false);

        jLabel18.setFont(new java.awt.Font("Norasi", 0, 14));
        jLabel18.setText("มูลค่าคงเหลือ");

        javax.swing.GroupLayout jPanel17Layout = new javax.swing.GroupLayout(jPanel17);
        jPanel17.setLayout(jPanel17Layout);
        jPanel17Layout.setHorizontalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel17Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(txtRowCount3, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(409, 409, 409)
                .addComponent(jLabel18)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtAmount3, javax.swing.GroupLayout.PREFERRED_SIZE, 186, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(55, 55, 55)
                .addComponent(cmdPrint3, javax.swing.GroupLayout.DEFAULT_SIZE, 67, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel17Layout.setVerticalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel17Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(txtRowCount3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmdPrint3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtAmount3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 980, Short.MAX_VALUE)
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel17, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 511, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jPanel17, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(123, 123, 123))
        );

        jTabbedPane1.addTab("สรุปมูลค่าสินค้าคงเหลือตามผู้ขาย (Vender)", jPanel3);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 1016, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jTabbedPane1)
                .addGap(40, 40, 40))
        );

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-1024)/2, (screenSize.height-768)/2, 1024, 768);
    }// </editor-fold>//GEN-END:initComponents

private void txtStockFile2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtStockFile2FocusGained
    txtStockFile2.selectAll();
}//GEN-LAST:event_txtStockFile2FocusGained

private void cmdStk2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdStk2ActionPerformed
    Jdi_browse_stockfile jbs = new Jdi_browse_stockfile(new NimbusFrame(), true);
    jbs.setLocation(cmdStk2.getLocationOnScreen());
    jbs.setVisible(true);
    if (jbs.getDataRecord() != null) {
        txtStockFile2.setText(jbs.getDataRecord().getStkcode());
        lbStockFile2.setText(jbs.getDataRecord().getStkname());
    }
}//GEN-LAST:event_cmdStk2ActionPerformed

private void cmdProcess2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdProcess2ActionPerformed
    
    cmdProcessGroup();
    
}//GEN-LAST:event_cmdProcess2ActionPerformed

private void cmdProcess2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdProcess2KeyPressed
// TODO add your handling code here:
}//GEN-LAST:event_cmdProcess2KeyPressed

private void txtStockFile1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtStockFile1FocusGained
// TODO add your handling code here:
}//GEN-LAST:event_txtStockFile1FocusGained

private void cmdStk1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdStk1ActionPerformed
    Jdi_browse_stockfile jbs = new Jdi_browse_stockfile(new NimbusFrame(), true);
    jbs.setLocation(cmdStk1.getLocationOnScreen());
    jbs.setVisible(true);
    if (jbs.getDataRecord() != null) {
        txtStockFile1.setText(jbs.getDataRecord().getStkcode());
        lbStockFile1.setText(jbs.getDataRecord().getStkname());
    }
}//GEN-LAST:event_cmdStk1ActionPerformed

private void cmdProcess1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdProcess1ActionPerformed
   
    cmdProcessProduct();
    
}//GEN-LAST:event_cmdProcess1ActionPerformed

private void cmdProcess1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdProcess1KeyPressed
// TODO add your handling code here:
}//GEN-LAST:event_cmdProcess1KeyPressed

private void cmdGroupFile1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdGroupFile1ActionPerformed
    jdi_showgroupfile js = new jdi_showgroupfile(new NimbusFrame(), true);
    js.setLocation(cmdGroupFile1.getLocationOnScreen());
    js.setVisible(true);
    try {
        txtGroupFile1.setText(js.getValueFromShowGroupFile()[0]);
    } catch (NullPointerException ex) {
    }
}//GEN-LAST:event_cmdGroupFile1ActionPerformed

private void cmdPrint2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPrint2ActionPerformed

    //
    Calendar month = new GregorianCalendar(Integer.parseInt(cbYear2.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth2.getSelectedItem().toString()) - 1, 1);
    int index = GetActionMon(month.getTime());
    System.out.println("BQTY" + index);
    String sql = "";
    if (index > 0 && index <= 24) {
        try {
            //Calendar month = new GregorianCalendar(Integer.parseInt(cbYear1.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth1.getSelectedItem().toString()) - 1, 1);
            ViewReport view = new ViewReport();
            utilities.convertToChar convert = new utilities.convertToChar();
           // int index = GetActionMon(month.getTime());
            String mo = cbMonth2.getSelectedItem().toString();
            String yy = cbYear2.getSelectedItem().toString();
            String timer = "(" + mo + "/" + yy + ") " + convert.convertMonthtoChar(mo) + "/" + yy + "";

            sql = "SELECT * , SUM(BQTY" + index + "*pprice11) AS AmountGroup " +
                    " FROM stkfile sf  LEFT JOIN product p ON sf.bpcode = p.pcode LEFT JOIN groupfile g ON p.pgroup = g.groupcode " +
                    " WHERE ( p.pactive = 'Y' AND p.pstock = 'Y' ) ";
            if(!txtStockFile2.getText().trim().equals("")){
                sql += "AND sf.bstk = '"+txtStockFile2.getText()+"'";
            }
            sql += "Group by p.pgroup ORDER BY pgroup";
            view.printConcludeGroup(timer, sql); 

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    } else {
        JOptionPane.showMessageDialog(this, "วันที่ไม่ได้อยู่ในการจัดเก็บ Stock ");
    }


}//GEN-LAST:event_cmdPrint2ActionPerformed

private void cmdPrint2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdPrint2KeyReleased
}//GEN-LAST:event_cmdPrint2KeyReleased

private void cmdPrint1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPrint1ActionPerformed
// TODO add your handling code here:
    //if (tblProduct.getRowCount() > 0) {
        String printby = "";
        if (jRadioButton1.isSelected()) {
            printby = "byPCode";
        } else if (jRadioButton2.isSelected()) {
            printby = "byGroup";
        } else {
            printby = "byVender";
        }
        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear1.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth1.getSelectedItem().toString()) - 1, 1);
        ViewReport view = new ViewReport();
        utilities.convertToChar convert = new utilities.convertToChar();

        int index = GetActionMon(month.getTime());
        String mo = cbMonth1.getSelectedItem().toString();
        String yy = cbYear1.getSelectedItem().toString();
        String timer = "(" + mo + "/" + yy + ") " + convert.convertMonthtoChar(mo) + "/" + yy + "";
        view.printstockControl(txtPcode1.getText(), txtGroupFile1.getText(), txtGroupFile2.getText(), txtVender1.getText(), txtStockFile1.getText(), printby, "BQTY" + index, timer);
    //1}
}//GEN-LAST:event_cmdPrint1ActionPerformed

private void cmdPrint1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdPrint1KeyReleased
// TODO add your handling code here:
}//GEN-LAST:event_cmdPrint1KeyReleased

private void txtStockFile3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtStockFile3FocusGained
// TODO add your handling code here:
}//GEN-LAST:event_txtStockFile3FocusGained

private void cmdStk3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdStk3ActionPerformed
    Jdi_browse_stockfile jbs = new Jdi_browse_stockfile(new NimbusFrame(), true);
    jbs.setLocation(cmdStk3.getLocationOnScreen());
    jbs.setVisible(true);
    if (jbs.getDataRecord() != null) {
        txtStockFile3.setText(jbs.getDataRecord().getStkcode());
        lbStockFile3.setText(jbs.getDataRecord().getStkname());
    }
}//GEN-LAST:event_cmdStk3ActionPerformed

private void cmdProcess3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdProcess3ActionPerformed
    
   
    cmdProcessVender();
    
}//GEN-LAST:event_cmdProcess3ActionPerformed

private void cmdProcess3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdProcess3KeyPressed
// TODO add your handling code here:
}//GEN-LAST:event_cmdProcess3KeyPressed

private void cmdGroupFile2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdGroupFile2ActionPerformed
    jdi_showgroupfile js = new jdi_showgroupfile(new NimbusFrame(), true);
    js.setLocation(cmdGroupFile2.getLocationOnScreen());
    js.setVisible(true);
    try {
        txtGroupFile2.setText(js.getValueFromShowGroupFile()[0]);
    } catch (NullPointerException ex) {
    }
}//GEN-LAST:event_cmdGroupFile2ActionPerformed

private void cmdPrint3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdPrint3ActionPerformed
// TODO add your handling code here:
     Calendar month = new GregorianCalendar(Integer.parseInt(cbYear3.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth3.getSelectedItem().toString()) - 1, 1);
    int index = GetActionMon(month.getTime());
    System.out.println("BQTY" + index);
    String sql = "";
    if (index > 0 && index <= 24) {
        try {
            //Calendar month = new GregorianCalendar(Integer.parseInt(cbYear1.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth1.getSelectedItem().toString()) - 1, 1);
            ViewReport view = new ViewReport();
            utilities.convertToChar convert = new utilities.convertToChar();
           // int index = GetActionMon(month.getTime());
            String mo = cbMonth3.getSelectedItem().toString();
            String yy = cbYear3.getSelectedItem().toString();
            String timer = "(" + mo + "/" + yy + ") " + convert.convertMonthtoChar(mo) + "/" + yy + "";

            sql = "SELECT * , SUM(BQTY" + index + "*pprice11) AS AmountGroup " +
                    " FROM stkfile sf  LEFT JOIN product p ON sf.bpcode = p.pcode LEFT JOIN vender v ON p.pvender = v.vcode  " +
                    " WHERE ( p.pactive = 'Y' AND p.pstock = 'Y' ) ";
            if(!txtStockFile3.getText().trim().equals("")){
                sql += "AND sf.bstk = '"+txtStockFile3.getText()+"'";
            }
            sql += " Group by p.pvender ORDER BY pvender";
            view.printConcludeVender(timer, sql); 

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    } else {
        JOptionPane.showMessageDialog(this, "วันที่ไม่ได้อยู่ในการจัดเก็บ Stock ");
    }
}//GEN-LAST:event_cmdPrint3ActionPerformed

private void cmdPrint3KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cmdPrint3KeyReleased
// TODO add your handling code here:
}//GEN-LAST:event_cmdPrint3KeyReleased

private void txtPcode1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtPcode1FocusGained
    txtPcode1.selectAll();
    txtPdesc1.setText("");
}//GEN-LAST:event_txtPcode1FocusGained

private void txtPdesc1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtPdesc1FocusGained
    txtPdesc1.selectAll();
    txtPcode1.setText("");
}//GEN-LAST:event_txtPdesc1FocusGained

private void cmdVender1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cmdVender1ActionPerformed
    Jdi_browse_vender jbs = new Jdi_browse_vender(new NimbusFrame(), true);
    jbs.setLocation(cmdVender1.getLocationOnScreen());
    jbs.setVisible(true);
    if (jbs.getVcode() != null) {
        txtVender1.setText(jbs.getVcode());
    }
}//GEN-LAST:event_cmdVender1ActionPerformed

private void txtStockFile1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtStockFile1KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdStk1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtStockFile1KeyReleased

private void txtStockFile2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtStockFile2KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdStk2ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess2ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtStockFile2KeyReleased

private void txtStockFile3KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtStockFile3KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdStk3ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess3ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtStockFile3KeyReleased

private void cbMonth3KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbMonth3KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess3ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbMonth3KeyReleased

private void cbYear3KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbYear3KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess3ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbYear3KeyReleased

private void cbYear2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbYear2KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess2ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbYear2KeyReleased

private void cbMonth2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbMonth2KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess2ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbMonth2KeyReleased

private void cbMonth1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbMonth1KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbMonth1KeyReleased

private void cbYear1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_cbYear1KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_cbYear1KeyReleased

private void txtGroupFile1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtGroupFile1KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdGroupFile1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtGroupFile1KeyReleased

private void txtGroupFile2KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtGroupFile2KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdGroupFile2ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtGroupFile2KeyReleased

private void txtVender1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtVender1KeyReleased
    if (evt.getKeyCode() == evt.VK_F1) {
        cmdVender1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtVender1KeyReleased

private void txtPdesc1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPdesc1KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtPdesc1KeyReleased

private void txtPcode1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPcode1KeyReleased
    if (evt.getKeyCode() == evt.VK_F5) {
        cmdProcess1ActionPerformed(new ActionEvent(new Object(), 0, "0"));
    }
}//GEN-LAST:event_txtPcode1KeyReleased

private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
    dispose();
}//GEN-LAST:event_jButton1ActionPerformed

private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
    dispose();
}//GEN-LAST:event_jButton2ActionPerformed

private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
    dispose();
}//GEN-LAST:event_jButton3ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                Jdi_report_stockinhand dialog = new Jdi_report_stockinhand(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {

                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox cbMonth1;
    private javax.swing.JComboBox cbMonth2;
    private javax.swing.JComboBox cbMonth3;
    private javax.swing.JComboBox cbYear1;
    private javax.swing.JComboBox cbYear2;
    private javax.swing.JComboBox cbYear3;
    private javax.swing.JButton cmdGroupFile1;
    private javax.swing.JButton cmdGroupFile2;
    private javax.swing.JButton cmdPrint1;
    private javax.swing.JButton cmdPrint2;
    private javax.swing.JButton cmdPrint3;
    private javax.swing.JButton cmdProcess1;
    private javax.swing.JButton cmdProcess2;
    private javax.swing.JButton cmdProcess3;
    private javax.swing.JButton cmdStk1;
    private javax.swing.JButton cmdStk2;
    private javax.swing.JButton cmdStk3;
    private javax.swing.JButton cmdVender1;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JRadioButton jRadioButton1;
    private javax.swing.JRadioButton jRadioButton2;
    private javax.swing.JRadioButton jRadioButton3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JLabel lbStockFile1;
    private javax.swing.JLabel lbStockFile2;
    private javax.swing.JLabel lbStockFile3;
    private javax.swing.JTable tblGroup;
    private javax.swing.JTable tblProduct;
    private javax.swing.JTable tblVender;
    private javax.swing.JTextField txtAmount1;
    private javax.swing.JTextField txtAmount2;
    private javax.swing.JTextField txtAmount3;
    private javax.swing.JTextField txtBqty1;
    private javax.swing.JTextField txtGroupFile1;
    private javax.swing.JTextField txtGroupFile2;
    private javax.swing.JTextField txtPcode1;
    private javax.swing.JTextField txtPdesc1;
    private javax.swing.JTextField txtRowCount1;
    private javax.swing.JTextField txtRowCount2;
    private javax.swing.JTextField txtRowCount3;
    private javax.swing.JTextField txtStockFile1;
    private javax.swing.JTextField txtStockFile2;
    private javax.swing.JTextField txtStockFile3;
    private javax.swing.JTextField txtVender1;
    // End of variables declaration//GEN-END:variables
    DefaultTableModel mPro,mGroup ,mVen ;
    SimpleDateFormat dateFmtShow = new SimpleDateFormat("dd/MM/yyyy", Locale.ENGLISH);
    SimpleDateFormat dateFmtSQL = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
    DecimalFormat IntegerFmt = new DecimalFormat("##,###,##0");
    DecimalFormat FloatFmt = new DecimalFormat("##,###,##0.00");

    private void setYear(DefaultComboBoxModel cbm) {
        Calendar today = Calendar.getInstance();
        SimpleDateFormat dateYearFmt = new SimpleDateFormat("yyyy", Locale.ENGLISH);


        int size = cbm.getSize();
        for (int i = 0; i < size; i++) {
            cbm.removeElementAt(0);
        }

        Calendar past = (Calendar) today.clone();
        past.set(Calendar.YEAR, 2000);
        Vector<String> temp = new Vector<String>();
        for (int i = 0; past.compareTo(today) <= 0; i++) {
            temp.add(dateYearFmt.format(past.getTime()));
            past.add(Calendar.YEAR, 1);
        }

        for (int i = temp.size() - 1; i > -1; i--) {
            cbm.addElement(temp.get(i));
        }



    }

    private int GetActionMon(Date EndofdayDate) {
        int RetVal = 0;
        SimpleDateFormat XYear = new SimpleDateFormat("yyyy", Locale.ENGLISH);
        SimpleDateFormat XMonth = new SimpleDateFormat("MM", Locale.ENGLISH);
        try {
            //new dbUtility().dbconnect();
            Statement stmt = (Statement) MySQLConnect.con.createStatement();
            String LoadTableFile = "select *from company";
            ResultSet rec = stmt.executeQuery(LoadTableFile);
            rec.first();
            if (rec.getRow() == 0) {
            } else {
                String TempYear = XYear.format(rec.getDate("accterm"));
                String TempMonth = XMonth.format(rec.getDate("accterm"));
                String CurYear = XYear.format(EndofdayDate);
                String CurMonth = XMonth.format(EndofdayDate);
                if (TempYear.equals(CurYear)) {
                    RetVal = Integer.parseInt(CurMonth) + 12;
                } else {
                    if (Integer.parseInt(CurYear) == Integer.parseInt(TempYear) - 1) {
                        RetVal = Integer.parseInt(CurMonth);
                    } else {
                        RetVal = 0;
                    }
                }
            }
            rec.close();
            stmt.close();
            //dbUtility.con.close();
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this, e.getMessage());
        }
        return RetVal;
    }

    private void cmdProcessProduct() {
        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear1.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth1.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);

        if (index > 0 && index <= 24) {
            try {
                resetTableModel(mPro);
                loadDataToTblProduct(getDataProductSQL());
                
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
        } else {
            JOptionPane.showMessageDialog(this, "วันที่ไม่ได้อยู่ในการจัดเก็บ Stock ");
        }
    }

    private void cmdProcessGroup() {
        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear2.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth2.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);       
        if (index > 0 && index <= 24) {
            try {
                resetTableModel(mGroup);
                loadDataToTblGroup(getDataGroupSQL());
                
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
        } else {
            JOptionPane.showMessageDialog(this, "วันที่ไม่ได้อยู่ในการจัดเก็บ Stock ");
        }
    }

    private void cmdProcessVender() {
        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear3.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth3.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);

        if (index > 0 && index <= 24) {
            try {
                resetTableModel(mVen);
                loadDataToTblVender(getDataVenderSQL());
                
            } catch (SQLException ex) {
                ex.printStackTrace();
            }
        } else {
            JOptionPane.showMessageDialog(this, "วันที่ไม่ได้อยู่ในการจัดเก็บ Stock ");
        }

    }

    private ResultSet getDataProductSQL() throws SQLException {
        String stock = txtStockFile1.getText().trim();
        String group1 = txtGroupFile1.getText().trim();
        String group2 = txtGroupFile2.getText().trim();
        String vender1 = txtVender1.getText().trim();
        String pcode1 = txtPcode1.getText().trim();
        String pdesc1 = txtPdesc1.getText().trim();

        String sql = "SELECT * " +
                " FROM stkfile sf " +
                " LEFT JOIN product p" +
                " ON sf.bpcode = p.pcode" +
                " WHERE ( p.pactive = 'Y' AND p.pstock = 'Y' )";

        if (!stock.equals("")) {
            sql += " AND sf.bstk = '" + stock + "'";
        }

        if (group1.equals("") && group2.equals("")) {
            sql = sql;
        } else if (!group1.equals("") && group2.equals("")) {
            sql += " AND (p.pgroup >='" + group1 + "')";
        } else {
            sql += " AND (p.pgroup between '" + group1 + "' AND '" + group2 + "')";
        }

        if (!vender1.equals("")) {
            sql += " AND p.pvender = '" + vender1 + "'";
        }

        if (!pcode1.equals("")) {
            sql += " AND p.pcode LIKE '%" + pcode1 + "%'";
        } else if (!pdesc1.equals("")) {
            sql += " AND p.pdesc LIKE '%" + pdesc1 + "%'";
        }


        sql += " ORDER BY pcode";
        System.out.println(sql);
        Statement stmt = (Statement)MySQLConnect.con.createStatement();
        ResultSet rs = stmt.executeQuery(sql);
       // stmt.close();
        return rs;
    }

    private void loadDataToTblProduct(ResultSet rs) throws SQLException {
        String[] row = new String[tblProduct.getColumnCount()];

        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear1.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth1.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);

        float sBQTY = 0;
        float sAmount = 0;
        while (rs.next()) {
            float amount = rs.getFloat("BQTY" + index) * rs.getFloat("pprice11");
            row[0] = rs.getString("bstk");
            row[1] = rs.getString("pcode");
            row[2] = rs.getString("pdesc");
            row[3] = rs.getString("pgroup");
            row[4] = rs.getString("pvender");
            row[5] = IntegerFmt.format(rs.getFloat("BQTY" + index));
            row[6] = rs.getString("punit1");
            row[7] = FloatFmt.format(rs.getFloat("pprice11"));
            row[8] = FloatFmt.format(amount);

            mPro.addRow(row);

            sBQTY += rs.getFloat("BQTY" + index);
            sAmount += amount;

        }
        txtRowCount1.setText(IntegerFmt.format(mPro.getRowCount()) + " รายการ");
        txtBqty1.setText(IntegerFmt.format(sBQTY));
        txtAmount1.setText(FloatFmt.format(sAmount));
    }

    private ResultSet getDataGroupSQL() throws SQLException {
        String stock = txtStockFile2.getText().trim();

        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear2.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth2.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);

        String sql = "SELECT * , " + "SUM(BQTY" + index + "*pprice11) AS AmountGroup" +
                " FROM stkfile sf " +
                " LEFT JOIN product p" +
                " ON sf.bpcode = p.pcode" +
                " LEFT JOIN groupfile g" +
                " ON p.pgroup = g.groupcode" +
                " WHERE ( p.pactive = 'Y' AND p.pstock = 'Y' )";


        if (!stock.equals("")) {
            sql += " AND sf.bstk = '" + stock + "'";
        }

        sql += " Group by p.pgroup";

        sql += " ORDER BY pgroup";
        System.out.println(sql);
        return MySQLConnect.con.createStatement().executeQuery(sql);
    }

    private void loadDataToTblGroup(ResultSet rs) throws SQLException {
        String[] row = new String[tblGroup.getColumnCount()];

        float sAmount = 0;
        while (rs.next()) {
            row[0] = rs.getString("bstk");
            row[1] = rs.getString("pgroup");
            row[2] = rs.getString("groupname");
            row[3] = FloatFmt.format(rs.getFloat("AmountGroup"));

            mGroup.addRow(row);

            sAmount += rs.getFloat("AmountGroup");

        }
        txtRowCount2.setText(IntegerFmt.format(mGroup.getRowCount()) + " รายการ");
        txtAmount2.setText(FloatFmt.format(sAmount));
        
    }

    private ResultSet getDataVenderSQL() throws SQLException {
        String stock = txtStockFile3.getText().trim();
        /*
        String group1 = txtGroupFile1.getText().trim();
        String group2 = txtGroupFile2.getText().trim();
        String vender1 = txtVender1.getText().trim();
        String pcode1 = txtPcode1.getText().trim();
        String pdesc1 = txtPdesc1.getText().trim();
         */

        Calendar month = new GregorianCalendar(Integer.parseInt(cbYear3.getSelectedItem().toString()), DateAndTime.convertStringToNumber(cbMonth3.getSelectedItem().toString()) - 1, 1);
        int index = GetActionMon(month.getTime());
        System.out.println("BQTY" + index);

        String sql = "SELECT * , " + "SUM(BQTY" + index + "*pprice11) AS AmountGroup" +
                " FROM stkfile sf " +
                " LEFT JOIN product p" +
                " ON sf.bpcode = p.pcode" +
                " LEFT JOIN vender v" +
                " ON p.pvender = v.vcode" +
                " WHERE ( p.pactive = 'Y' AND p.pstock = 'Y' )";


        if (!stock.equals("")) {
            sql += " AND sf.bstk = '" + stock + "'";
        }

        sql += " Group by p.pvender";

        /*
        if(group1.equals("") && group2.equals("")){
        sql = sql;
        }else if(!group1.equals("") && group2.equals("")){
        sql += " AND (p.pgroup >='"+group1+"')";
        }else{
        sql += " AND (p.pgroup between '"+group1+"' AND '"+group2+"')";
        }
        
        if(!vender1.equals("")){
        sql += " AND p.pvender = '"+vender1+"'";
        }
        
        if(!pcode1.equals("")){
        sql += " AND p.pcode LIKE '%"+pcode1+"%'";
        }else if(!pdesc1.equals("")){
        sql += " AND p.pdesc LIKE '%"+pdesc1+"%'";
        }
        
         */

        sql += " ORDER BY pvender";
        System.out.println(sql);
        return MySQLConnect.con.createStatement().executeQuery(sql);
    }

    private void loadDataToTblVender(ResultSet rs) throws SQLException {
        String[] row = new String[tblVender.getColumnCount()];

        float sAmount = 0;
        while (rs.next()) {
            row[0] = rs.getString("bstk");
            row[1] = rs.getString("pvender");
            row[2] = rs.getString("vname");
            row[3] = FloatFmt.format(rs.getFloat("AmountGroup"));

            mVen.addRow(row);

            sAmount += rs.getFloat("AmountGroup");

        }
        txtRowCount3.setText(IntegerFmt.format(mVen.getRowCount()) + " รายการ");
        txtAmount3.setText(FloatFmt.format(sAmount));
    }

    private void setTableProduct() {

        tblProduct.setShowGrid(true);
        tblProduct.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblProduct.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblProduct.setRowSelectionAllowed(true);
        tblProduct.setShowGrid(true);
        tblProduct.setBackground(Color.WHITE);
        tblProduct.setGridColor(Color.LIGHT_GRAY);

        JTableHeader header = tblProduct.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblProduct.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblProduct.setRowHeight(25);

        //Setting column size
        TableColumn column = null;
        int[] colSize = {50, 80, 255, 80, 80, 100, 80, 120, 130};
        tblProduct.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        for (int i = 0; i < tblProduct.getColumnCount(); i++) {
            column = tblProduct.getColumnModel().getColumn(i);
            column.setPreferredWidth(colSize[i]);
        }

        TableColumnModel tcm = tblProduct.getColumnModel();

        DefaultTableCellRenderer d;

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.LEADING);
        tcm.getColumn(1).setCellRenderer(d);
        tcm.getColumn(2).setCellRenderer(d);
        tcm.getColumn(3).setCellRenderer(d);
        tcm.getColumn(4).setCellRenderer(d);
        tcm.getColumn(6).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.CENTER);
        tcm.getColumn(0).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.RIGHT);
        tcm.getColumn(5).setCellRenderer(d);
        tcm.getColumn(7).setCellRenderer(d);
        tcm.getColumn(8).setCellRenderer(d);

    }

    private void setTableGroup() {
        tblGroup.setShowGrid(true);
        tblGroup.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblGroup.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblGroup.setRowSelectionAllowed(true);
        tblGroup.setShowGrid(true);
        tblGroup.setBackground(Color.WHITE);
        tblGroup.setGridColor(Color.LIGHT_GRAY);

        JTableHeader header = tblGroup.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblGroup.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblGroup.setRowHeight(25);

        //Setting column size
        TableColumn column = null;
        int[] colSize = {70, 150, 400, 210};
        tblGroup.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        for (int i = 0; i < tblGroup.getColumnCount(); i++) {
            column = tblGroup.getColumnModel().getColumn(i);
            column.setPreferredWidth(colSize[i]);
        }

        TableColumnModel tcm = tblGroup.getColumnModel();

        DefaultTableCellRenderer d;

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.LEADING);
        tcm.getColumn(1).setCellRenderer(d);
        tcm.getColumn(2).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.CENTER);
        tcm.getColumn(0).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.RIGHT);
        tcm.getColumn(3).setCellRenderer(d);

    }

    private void setTableVender() {
        tblVender.setShowGrid(true);
        tblVender.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblVender.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblVender.setRowSelectionAllowed(true);
        tblVender.setShowGrid(true);
        tblVender.setBackground(Color.WHITE);
        tblVender.setGridColor(Color.LIGHT_GRAY);

        JTableHeader header = tblVender.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblVender.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblVender.setRowHeight(25);

        //Setting column size
        TableColumn column = null;
        int[] colSize = {70, 150, 400, 210};
        tblVender.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        for (int i = 0; i < tblVender.getColumnCount(); i++) {
            column = tblVender.getColumnModel().getColumn(i);
            column.setPreferredWidth(colSize[i]);
        }

        TableColumnModel tcm = tblVender.getColumnModel();

        DefaultTableCellRenderer d;

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.LEADING);
        tcm.getColumn(1).setCellRenderer(d);
        tcm.getColumn(2).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.CENTER);
        tcm.getColumn(0).setCellRenderer(d);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.RIGHT);
        tcm.getColumn(3).setCellRenderer(d);
    }

    private void resetTableModel(DefaultTableModel model) {
        int rowCount = model.getRowCount();
        for (int i = 0; i < rowCount; i++) {
            model.removeRow(0);
        }
    }
}
